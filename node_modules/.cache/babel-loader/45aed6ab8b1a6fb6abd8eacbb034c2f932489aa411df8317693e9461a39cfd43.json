{"ast":null,"code":"import axios from \"axios\";\nimport { publicRequest, userRequest } from \"../requestMethods\";\nimport { clearCart, fetchCart } from \"./cartRedux\";\nimport { loginFailure, loginStart, loginSuccess, refreshTokenStart, refreshTokenSuccess, refreshTokenFailure, logoutStart, logoutSuccess, logoutFailure } from \"./userRedux\";\nimport { clearWishlist, fetchWishlist } from \"./wishlistRedux\";\nimport { toast } from 'react-hot-toast';\n\n// export const refreshAccessToken = async (dispatch, refreshToken, refreshTokenId) => {\n//     dispatch(refreshTokenStart());\n//     try {\n//         const res = await userRequest.post(\"/refresh_token\", {refreshToken, refreshTokenId}, { \n//             withCredentials: true\n//         });\n//         console.log(res.data)\n//         dispatch(refreshTokenSuccess(res.data));\n//     } catch(err) {\n//         dispatch(refreshTokenFailure());\n//     }\n// };\n\nexport const login = async (dispatch, user) => {\n  dispatch(loginStart());\n  try {\n    const res = await publicRequest.post(\"/auth/login\", user);\n    console.log(res.data);\n    dispatch(loginSuccess(res.data));\n    localStorage.setItem();\n  } catch (err) {\n    console.log(err);\n    dispatch(loginFailure());\n    toast.error(err.response.data.error);\n  }\n};\nexport const logout = async (dispatch, user) => {\n  dispatch(logoutStart());\n  const {\n    _id,\n    refreshTokenId\n  } = user;\n  try {\n    const res = await userRequest.delete(\"/auth/logout\", {\n      userId: _id,\n      refreshTokenId\n    });\n    if (res) {\n      dispatch(logoutSuccess());\n      dispatch(clearCart());\n      dispatch(clearWishlist());\n      localStorage.clear();\n    }\n  } catch (err) {\n    console.log(err);\n    dispatch(logoutFailure());\n  }\n};","map":{"version":3,"names":["axios","publicRequest","userRequest","clearCart","fetchCart","loginFailure","loginStart","loginSuccess","refreshTokenStart","refreshTokenSuccess","refreshTokenFailure","logoutStart","logoutSuccess","logoutFailure","clearWishlist","fetchWishlist","toast","login","dispatch","user","res","post","console","log","data","localStorage","setItem","err","error","response","logout","_id","refreshTokenId","delete","userId","clear"],"sources":["D:/Work/vinogradnik/client/src/redux/apiCalls.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { publicRequest, userRequest } from \"../requestMethods\";\r\nimport { clearCart, fetchCart } from \"./cartRedux\";\r\nimport { \r\n    loginFailure, \r\n    loginStart, \r\n    loginSuccess, \r\n    refreshTokenStart,\r\n    refreshTokenSuccess,\r\n    refreshTokenFailure,\r\n    logoutStart, \r\n    logoutSuccess, \r\n    logoutFailure \r\n} from \"./userRedux\"\r\nimport { clearWishlist, fetchWishlist } from \"./wishlistRedux\";\r\nimport { toast } from 'react-hot-toast';\r\n\r\n// export const refreshAccessToken = async (dispatch, refreshToken, refreshTokenId) => {\r\n//     dispatch(refreshTokenStart());\r\n//     try {\r\n//         const res = await userRequest.post(\"/refresh_token\", {refreshToken, refreshTokenId}, { \r\n//             withCredentials: true\r\n//         });\r\n//         console.log(res.data)\r\n//         dispatch(refreshTokenSuccess(res.data));\r\n//     } catch(err) {\r\n//         dispatch(refreshTokenFailure());\r\n//     }\r\n// };\r\n\r\nexport const login = async (dispatch, user) => {\r\n    dispatch(loginStart());\r\n    try {\r\n        const res = await publicRequest.post(\"/auth/login\", user)\r\n        console.log(res.data)\r\n        dispatch(loginSuccess(res.data))\r\n        localStorage.setItem()\r\n    } catch(err) {\r\n        console.log(err)\r\n        dispatch(loginFailure());\r\n        toast.error(err.response.data.error);\r\n    }\r\n};\r\n\r\nexport const logout = async (dispatch, user) => {\r\n    dispatch(logoutStart());\r\n    const { _id, refreshTokenId } = user;\r\n    try {\r\n        const res = await userRequest.delete(\"/auth/logout\", {userId: _id, refreshTokenId});\r\n        if (res) {\r\n            dispatch(logoutSuccess());\r\n            dispatch(clearCart());\r\n            dispatch(clearWishlist());\r\n            localStorage.clear();\r\n        } \r\n    } catch(err) {\r\n        console.log(err);\r\n        dispatch(logoutFailure());\r\n    }\r\n};"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa,EAAEC,WAAW,QAAQ,mBAAmB;AAC9D,SAASC,SAAS,EAAEC,SAAS,QAAQ,aAAa;AAClD,SACIC,YAAY,EACZC,UAAU,EACVC,YAAY,EACZC,iBAAiB,EACjBC,mBAAmB,EACnBC,mBAAmB,EACnBC,WAAW,EACXC,aAAa,EACbC,aAAa,QACV,aAAa;AACpB,SAASC,aAAa,EAAEC,aAAa,QAAQ,iBAAiB;AAC9D,SAASC,KAAK,QAAQ,iBAAiB;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,KAAK,GAAG,OAAOC,QAAQ,EAAEC,IAAI,KAAK;EAC3CD,QAAQ,CAACZ,UAAU,EAAE,CAAC;EACtB,IAAI;IACA,MAAMc,GAAG,GAAG,MAAMnB,aAAa,CAACoB,IAAI,CAAC,aAAa,EAAEF,IAAI,CAAC;IACzDG,OAAO,CAACC,GAAG,CAACH,GAAG,CAACI,IAAI,CAAC;IACrBN,QAAQ,CAACX,YAAY,CAACa,GAAG,CAACI,IAAI,CAAC,CAAC;IAChCC,YAAY,CAACC,OAAO,EAAE;EAC1B,CAAC,CAAC,OAAMC,GAAG,EAAE;IACTL,OAAO,CAACC,GAAG,CAACI,GAAG,CAAC;IAChBT,QAAQ,CAACb,YAAY,EAAE,CAAC;IACxBW,KAAK,CAACY,KAAK,CAACD,GAAG,CAACE,QAAQ,CAACL,IAAI,CAACI,KAAK,CAAC;EACxC;AACJ,CAAC;AAED,OAAO,MAAME,MAAM,GAAG,OAAOZ,QAAQ,EAAEC,IAAI,KAAK;EAC5CD,QAAQ,CAACP,WAAW,EAAE,CAAC;EACvB,MAAM;IAAEoB,GAAG;IAAEC;EAAe,CAAC,GAAGb,IAAI;EACpC,IAAI;IACA,MAAMC,GAAG,GAAG,MAAMlB,WAAW,CAAC+B,MAAM,CAAC,cAAc,EAAE;MAACC,MAAM,EAAEH,GAAG;MAAEC;IAAc,CAAC,CAAC;IACnF,IAAIZ,GAAG,EAAE;MACLF,QAAQ,CAACN,aAAa,EAAE,CAAC;MACzBM,QAAQ,CAACf,SAAS,EAAE,CAAC;MACrBe,QAAQ,CAACJ,aAAa,EAAE,CAAC;MACzBW,YAAY,CAACU,KAAK,EAAE;IACxB;EACJ,CAAC,CAAC,OAAMR,GAAG,EAAE;IACTL,OAAO,CAACC,GAAG,CAACI,GAAG,CAAC;IAChBT,QAAQ,CAACL,aAAa,EAAE,CAAC;EAC7B;AACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}