{"ast":null,"code":"import _regeneratorRuntime from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8;import{useEffect,useState}from'react';import{Link,useLocation}from'react-router-dom';import ShoppingCartCheckoutIcon from'@mui/icons-material/ShoppingCartCheckout';import{clearCart}from'../redux/cartRedux';import{useDispatch,useSelector}from'react-redux';import{runFireworks}from'../lib/utils';import styled from'styled-components';import{publicRequest}from\"../requestMethods\";import{useTranslation}from\"react-i18next\";import{memo}from'react';import{mobileLarge}from'../responsive';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  background-color: white;\\n  min-height: 60vh;\\n\"])));var Wrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  width: 1000px;\\n  margin: auto;\\n  margin-top: 160px;\\n  background-color: #dcdcdc;\\n  padding: 50px;\\n  border-radius: 15px;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  flex-direction: column;\\n  \",\"\\n\"])),mobileLarge({width:'90vw',marginTop:'50px',padding:'20px'}));var Icon=styled.p(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n   color: green;\\n   font-size: 40px; \\n\"])));var ThankYou=styled.h2(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  text-transform: capitalize;\\n  margin-top: 15px 0px;\\n  font-weight: 900;\\n  font-size: 40px;\\n  color:#324d67;\\n  text-align: center;\\n  \",\"\\n\"])),mobileLarge({fontSize:'30px',fontWeight:'400',marginTop:'10px'}));var EmailMsg=styled.p(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  font-size: 16px;\\n  font-weight: 600;\\n  text-align: center;\\n  \",\"\\n\"])),mobileLarge({fontWeight:'400'}));var Desc=styled.p(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  font-size: 16px;\\n  font-weight: 600;\\n  text-align: center;\\n  margin: 10px;\\n  margin-top: 30px;\\n  \",\"\\n\"])),mobileLarge({fontWeight:'400'}));var EmailTo=styled.a(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  margin-left: 5px;\\n  color: #f02d34;\\n\"])));var Button=styled.button(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n    padding: 10px;\\n    font-weight: 600;\\n    cursor: pointer;\\n    background-color: black;\\n    color: white;\\n    margin-top: 10px;\\n    \",\"\\n\"])),mobileLarge({fontSize:'18px',fontWeight:'400'}));var Success=function Success(){var location=useLocation();var data=location.state.stripeData;var cart=location.state.cart;var email=location.state.email;var currentUser=useSelector(function(state){return state.user.currentUser;});var _useState=useState(null),_useState2=_slicedToArray(_useState,2),orderId=_useState2[0],setOrderId=_useState2[1];var dispatch=useDispatch();var _useTranslation=useTranslation([\"success\"]),t=_useTranslation.t;useEffect(function(){data&&_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return publicRequest.post(\"/orders\",{userId:currentUser===null||currentUser===void 0?void 0:currentUser._id,products:cart.products.map(function(item){return{productId:item._id,quantity:item.quantity,title:item.title,color:item.color,price:item.price};}),amount:cart.totalPrice,address:data.billing_details.address,email:email});case 3:res=_context.sent;setOrderId(res.data._id);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:;case 11:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}))();localStorage.clear();dispatch(clearCart());runFireworks();},[cart,data,currentUser,dispatch,email]);return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsx(Icon,{children:/*#__PURE__*/_jsx(ShoppingCartCheckoutIcon,{})}),/*#__PURE__*/_jsx(ThankYou,{children:t(\"thank_you\")}),/*#__PURE__*/_jsx(EmailMsg,{children:t(\"check_email\")}),/*#__PURE__*/_jsxs(Desc,{children:[t(\"questions\"),/*#__PURE__*/_jsx(EmailTo,{href:\"mailto:ivanzlatoff@gmail.com\",children:\"ivanzlatoff@gmail.com\"})]}),orderId?\"\".concat(t(\"order_created\"),\" \").concat(orderId.slice(-6)):\"\".concat(t(\"preparing\")),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(Button,{children:t(\"go_home\")})})]})});};export default/*#__PURE__*/memo(Success);","map":{"version":3,"names":["useEffect","useState","Link","useLocation","ShoppingCartCheckoutIcon","clearCart","useDispatch","useSelector","runFireworks","styled","publicRequest","useTranslation","memo","mobileLarge","Container","div","Wrapper","width","marginTop","padding","Icon","p","ThankYou","h2","fontSize","fontWeight","EmailMsg","Desc","EmailTo","a","Button","button","Success","location","data","state","stripeData","cart","email","currentUser","user","orderId","setOrderId","dispatch","t","post","userId","_id","products","map","item","productId","quantity","title","color","price","amount","totalPrice","address","billing_details","res","console","log","localStorage","clear","slice"],"sources":["D:/Work/vinogradnik/client/src/pages/Success.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { Link, useLocation } from 'react-router-dom';\r\nimport ShoppingCartCheckoutIcon from '@mui/icons-material/ShoppingCartCheckout';\r\nimport { clearCart } from '../redux/cartRedux';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { runFireworks } from '../lib/utils';\r\nimport styled from 'styled-components';\r\nimport { publicRequest } from \"../requestMethods\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { memo } from 'react';\r\nimport { mobileLarge } from '../responsive';\r\n\r\n\r\nconst Container = styled.div`\r\n  background-color: white;\r\n  min-height: 60vh;\r\n`;\r\n\r\nconst Wrapper = styled.div`\r\n  width: 1000px;\r\n  margin: auto;\r\n  margin-top: 160px;\r\n  background-color: #dcdcdc;\r\n  padding: 50px;\r\n  border-radius: 15px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  ${mobileLarge({\r\n    width: '90vw',\r\n    marginTop: '50px',\r\n    padding: '20px'\r\n  })}\r\n`;\r\n\r\nconst Icon = styled.p`\r\n   color: green;\r\n   font-size: 40px; \r\n`;\r\n\r\nconst ThankYou = styled.h2`\r\n  text-transform: capitalize;\r\n  margin-top: 15px 0px;\r\n  font-weight: 900;\r\n  font-size: 40px;\r\n  color:#324d67;\r\n  text-align: center;\r\n  ${mobileLarge({\r\n    fontSize: '30px',\r\n    fontWeight: '400',\r\n    marginTop: '10px'\r\n  })}\r\n`;\r\n\r\nconst EmailMsg = styled.p`\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  text-align: center;\r\n  ${mobileLarge({\r\n    fontWeight: '400'\r\n  })}\r\n`;\r\n\r\nconst Desc = styled.p`\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  text-align: center;\r\n  margin: 10px;\r\n  margin-top: 30px;\r\n  ${mobileLarge({\r\n    fontWeight: '400',\r\n  })}\r\n`;\r\n\r\nconst EmailTo = styled.a`\r\n  margin-left: 5px;\r\n  color: #f02d34;\r\n`;\r\n\r\nconst Button = styled.button`\r\n    padding: 10px;\r\n    font-weight: 600;\r\n    cursor: pointer;\r\n    background-color: black;\r\n    color: white;\r\n    margin-top: 10px;\r\n    ${mobileLarge({\r\n      fontSize: '18px',\r\n      fontWeight: '400'\r\n    })}\r\n`;\r\n\r\nconst Success = () => {\r\n  const location = useLocation();\r\n  const data = location.state.stripeData;\r\n  const cart = location.state.cart;\r\n  const email = location.state.email;\r\n  const currentUser = useSelector((state) => state.user.currentUser);\r\n  const [orderId, setOrderId] = useState(null);\r\n  const dispatch = useDispatch();\r\n  const { t } = useTranslation([\"success\"]);\r\n    \r\n    useEffect(() => {\r\n      data && (async () => {\r\n        try {\r\n          const res = await publicRequest.post(\"/orders\", {\r\n              userId: currentUser?._id,\r\n              products: cart.products.map((item) => ({\r\n                productId: item._id,\r\n                quantity: item.quantity,\r\n                title: item.title,\r\n                color: item.color,\r\n                price: item.price\r\n            })),\r\n            amount: cart.totalPrice,\r\n            address: data.billing_details.address,\r\n            email\r\n          });\r\n          setOrderId(res.data._id);\r\n        } catch(err) {\r\n          console.log(err);\r\n        };\r\n      })();\r\n      localStorage.clear();\r\n      dispatch(\r\n        clearCart()\r\n      );\r\n      runFireworks();\r\n    }, [cart, data, currentUser, dispatch, email]);\r\n\r\n  return (\r\n    <Container>\r\n      <Wrapper>\r\n          <Icon>\r\n            <ShoppingCartCheckoutIcon />\r\n          </Icon>\r\n          <ThankYou>{t(\"thank_you\")}</ThankYou>\r\n          <EmailMsg>{t(\"check_email\")}</EmailMsg>\r\n          <Desc>\r\n              {t(\"questions\")}\r\n              <EmailTo href=\"mailto:ivanzlatoff@gmail.com\">\r\n                ivanzlatoff@gmail.com\r\n              </EmailTo>  \r\n          </Desc>\r\n          {orderId\r\n            ? `${t(\"order_created\")} ${orderId.slice(-6)}`\r\n            : `${t(\"preparing\")}`}\r\n          <Link to=\"/\">\r\n              <Button>\r\n                  {t(\"go_home\")}\r\n              </Button>\r\n          </Link>\r\n      </Wrapper>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default memo(Success)\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}