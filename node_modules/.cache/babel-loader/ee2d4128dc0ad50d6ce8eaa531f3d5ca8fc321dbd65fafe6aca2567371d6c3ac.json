{"ast":null,"code":"import _regeneratorRuntime from\"D:/Work/VB/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectWithoutProperties from\"D:/Work/VB/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _asyncToGenerator from\"D:/Work/VB/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _excluded=[\"accessToken\",\"refreshToken\",\"refreshTokenId\"];import{clearRefreshToken,publicRequest,updateRefreshToken,userRequest}from\"../requestMethods\";import{loginFailure,loginStart,loginSuccess,logoutStart,logoutSuccess,logoutFailure}from\"./userRedux\";import{toast}from'react-hot-toast';export var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch,user){var res,_res$data,accessToken,refreshToken,refreshTokenId,others;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dispatch(loginStart());_context.prev=1;_context.next=4;return publicRequest.post(\"/auth/login\",user);case 4:res=_context.sent;_res$data=res.data,accessToken=_res$data.accessToken,refreshToken=_res$data.refreshToken,refreshTokenId=_res$data.refreshTokenId,others=_objectWithoutProperties(_res$data,_excluded);dispatch(loginSuccess(others));updateRefreshToken(refreshToken,refreshTokenId);_context.next=15;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.log(_context.t0);dispatch(loginFailure());toast.error(_context.t0.response.data.error);case 15:case\"end\":return _context.stop();}},_callee,null,[[1,10]]);}));return function login(_x,_x2){return _ref.apply(this,arguments);};}();export var logout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch,refreshTokenId){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:dispatch(logoutStart());_context2.prev=1;_context2.next=4;return userRequest.post(\"/auth/logout_post\",refreshTokenId);case 4:dispatch(logoutSuccess());clearRefreshToken();delete userRequest.defaults.headers.common[\"token\"];_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch(logoutFailure());console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[1,9]]);}));return function logout(_x3,_x4){return _ref2.apply(this,arguments);};}();","map":{"version":3,"names":["clearRefreshToken","publicRequest","updateRefreshToken","userRequest","loginFailure","loginStart","loginSuccess","logoutStart","logoutSuccess","logoutFailure","toast","login","dispatch","user","post","res","data","accessToken","refreshToken","refreshTokenId","others","console","log","error","response","logout","defaults","headers","common"],"sources":["D:/Work/VB/client/src/redux/apiCalls.js"],"sourcesContent":["import { clearRefreshToken, publicRequest, updateRefreshToken, userRequest } from \"../requestMethods\";\r\nimport { \r\n    loginFailure, \r\n    loginStart, \r\n    loginSuccess,\r\n    logoutStart, \r\n    logoutSuccess, \r\n    logoutFailure \r\n} from \"./userRedux\"\r\nimport { toast } from 'react-hot-toast';\r\n\r\n\r\nexport const login = async (dispatch, user) => {\r\n    dispatch(loginStart());\r\n    try {\r\n        const res = await publicRequest.post(\"/auth/login\", user);\r\n        const { accessToken, refreshToken, refreshTokenId, ...others } = res.data;\r\n        dispatch(loginSuccess(others));\r\n        updateRefreshToken(refreshToken, refreshTokenId);\r\n    } catch(err) {\r\n        console.log(err)\r\n        dispatch(loginFailure());\r\n        toast.error(err.response.data.error);\r\n    }\r\n};\r\n\r\nexport const logout = async (dispatch, refreshTokenId) => {\r\n    dispatch(logoutStart());\r\n    try {\r\n        await userRequest.post(\"/auth/logout_post\", refreshTokenId)\r\n        dispatch(logoutSuccess());\r\n        clearRefreshToken();\r\n        delete userRequest.defaults.headers.common[\"token\"];\r\n    } catch(err) {\r\n        dispatch(logoutFailure());\r\n        console.log(err);\r\n    }\r\n};"],"mappings":"uZAAA,OAASA,iBAAiB,CAAEC,aAAa,CAAEC,kBAAkB,CAAEC,WAAW,KAAQ,mBAAmB,CACrG,OACIC,YAAY,CACZC,UAAU,CACVC,YAAY,CACZC,WAAW,CACXC,aAAa,CACbC,aAAa,KACV,aAAa,CACpB,OAASC,KAAK,KAAQ,iBAAiB,CAGvC,MAAO,IAAMC,MAAK,4FAAG,iBAAOC,QAAQ,CAAEC,IAAI,oLACtCD,QAAQ,CAACP,UAAU,EAAE,CAAC,CAAC,sCAEDJ,cAAa,CAACa,IAAI,CAAC,aAAa,CAAED,IAAI,CAAC,QAAnDE,GAAG,yBACwDA,GAAG,CAACC,IAAI,CAAjEC,WAAW,WAAXA,WAAW,CAAEC,YAAY,WAAZA,YAAY,CAAEC,cAAc,WAAdA,cAAc,CAAKC,MAAM,+CAC5DR,QAAQ,CAACN,YAAY,CAACc,MAAM,CAAC,CAAC,CAC9BlB,kBAAkB,CAACgB,YAAY,CAAEC,cAAc,CAAC,CAAC,iFAEjDE,OAAO,CAACC,GAAG,aAAK,CAChBV,QAAQ,CAACR,YAAY,EAAE,CAAC,CACxBM,KAAK,CAACa,KAAK,CAAC,YAAIC,QAAQ,CAACR,IAAI,CAACO,KAAK,CAAC,CAAC,oEAE5C,kBAZYZ,MAAK,gDAYjB,CAED,MAAO,IAAMc,OAAM,6FAAG,kBAAOb,QAAQ,CAAEO,cAAc,uHACjDP,QAAQ,CAACL,WAAW,EAAE,CAAC,CAAC,wCAEdJ,YAAW,CAACW,IAAI,CAAC,mBAAmB,CAAEK,cAAc,CAAC,QAC3DP,QAAQ,CAACJ,aAAa,EAAE,CAAC,CACzBR,iBAAiB,EAAE,CACnB,MAAOG,YAAW,CAACuB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,OAAO,CAAC,CAAC,mFAEpDhB,QAAQ,CAACH,aAAa,EAAE,CAAC,CACzBY,OAAO,CAACC,GAAG,cAAK,CAAC,qEAExB,kBAXYG,OAAM,kDAWlB"},"metadata":{},"sourceType":"module","externalDependencies":[]}