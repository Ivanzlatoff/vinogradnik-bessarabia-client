{"ast":null,"code":"import _toConsumableArray from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"D:/Work/vinogradnik/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{useEffect,useState}from'react';import styled from'styled-components';import Product from'./Product';import axios from'axios';import{memo}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n  display: flex;\\n  flex-wrap: wrap;\\n  justify-content: space-between;\\n\"])));var Products=function Products(_ref){var category=_ref.category,filters=_ref.filters,sort=_ref.sort;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),filteredProducts=_useState4[0],setFilteredProducts=_useState4[1];useEffect(function(){var ignore=false;_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(category?\"http://localhost:5000/api/products?category=\".concat(category):'http://localhost:5000/api/products');case 3:res=_context.sent;!ignore&&setProducts(res.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}))();return function(){ignore=true;};},[category]);useEffect(function(){category&&setFilteredProducts(products.filter(function(item){return Object.entries(filters).every(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];return item[key].includes(value);});}));},[products,category,filters]);useEffect(function(){if(sort==='Newest'){setFilteredProducts(function(prev){return _toConsumableArray(prev).sort(function(a,b){return a.createdAt-b.createdAt;});});}else if(sort==='asc'){setFilteredProducts(function(prev){return _toConsumableArray(prev).sort(function(a,b){return a.price-b.price;});});}else{setFilteredProducts(function(prev){return _toConsumableArray(prev).sort(function(a,b){return b.price-a.price;});});}},[sort]);return/*#__PURE__*/_jsx(Container,{children:category?filteredProducts.map(function(item){return/*#__PURE__*/_jsx(Product,{item:item},item._id);}):products.map(function(item){return/*#__PURE__*/_jsx(Product,{item:item},item._id);})});};export default/*#__PURE__*/memo(Products);","map":{"version":3,"names":["useEffect","useState","styled","Product","axios","memo","Container","div","Products","category","filters","sort","products","setProducts","filteredProducts","setFilteredProducts","ignore","get","res","data","console","log","filter","item","Object","entries","every","key","value","includes","prev","a","b","createdAt","price","map","_id"],"sources":["D:/Work/vinogradnik/client/src/components/Products.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport Product from './Product';\r\nimport axios from 'axios';\r\nimport { memo } from 'react';\r\n\r\nconst Container = styled.div`\r\n  padding: 20px;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n`\r\n\r\nconst Products = ({ category, filters, sort }) => {\r\n  const [products, setProducts] = useState([]);\r\n  const [filteredProducts, setFilteredProducts] = useState([]);\r\n\r\n  useEffect(() => {\r\n    let ignore = false;\r\n\r\n    (async () => {\r\n      try {\r\n        const res = await axios.get(\r\n          category \r\n            ? `http://localhost:5000/api/products?category=${category}` \r\n            : 'http://localhost:5000/api/products'\r\n          );\r\n        !ignore && setProducts(res.data);\r\n      } catch(err) {\r\n        console.log(err);\r\n      }\r\n    })();\r\n\r\n    return () => {\r\n      ignore = true;\r\n    };\r\n  }, [category]);\r\n\r\n  useEffect(() => {\r\n    category &&\r\n      setFilteredProducts(\r\n        products.filter((item) => \r\n          Object.entries(filters).every(([key, value]) => \r\n            item[key].includes(value),\r\n          )\r\n        )\r\n      );\r\n  }, [products, category, filters]);\r\n\r\n  useEffect(() => {\r\n    if (sort === 'Newest') {\r\n      setFilteredProducts((prev) => \r\n        [...prev].sort((a, b) => a.createdAt - b.createdAt)\r\n      );\r\n    } else if (sort === 'asc') {\r\n      setFilteredProducts((prev) => \r\n        [...prev].sort((a, b) => a.price - b.price)\r\n      );\r\n    } else {\r\n      setFilteredProducts((prev) =>\r\n        [...prev].sort((a, b) => b.price - a.price)\r\n      )\r\n    }\r\n  }, [sort])\r\n\r\n  return (\r\n    <Container>\r\n      {category \r\n        ? filteredProducts.map(item => (<Product item={item} key={item._id}/>)) \r\n        : products.map(item => (<Product item={item} key={item._id}/>))}\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default memo(Products)\r\n"],"mappings":"4mBAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAOC,OAAM,KAAM,mBAAmB,CACtC,MAAOC,QAAO,KAAM,WAAW,CAC/B,MAAOC,MAAK,KAAM,OAAO,CACzB,OAASC,IAAI,KAAQ,OAAO,CAAC,2CAE7B,GAAMC,UAAS,CAAGJ,MAAM,CAACK,GAAG,8JAK3B,CAED,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,MAAoC,IAA9BC,SAAQ,MAARA,QAAQ,CAAEC,OAAO,MAAPA,OAAO,CAAEC,IAAI,MAAJA,IAAI,CACzC,cAAgCV,QAAQ,CAAC,EAAE,CAAC,wCAArCW,QAAQ,eAAEC,WAAW,eAC5B,eAAgDZ,QAAQ,CAAC,EAAE,CAAC,yCAArDa,gBAAgB,eAAEC,mBAAmB,eAE5Cf,SAAS,CAAC,UAAM,CACd,GAAIgB,OAAM,CAAG,KAAK,CAElB,0DAAC,kLAEqBZ,MAAK,CAACa,GAAG,CACzBR,QAAQ,uDAC2CA,QAAQ,EACvD,oCAAoC,CACvC,QAJGS,GAAG,eAKT,CAACF,MAAM,EAAIH,WAAW,CAACK,GAAG,CAACC,IAAI,CAAC,CAAC,+EAEjCC,OAAO,CAACC,GAAG,aAAK,CAAC,mEAEpB,IAAG,CAEJ,MAAO,WAAM,CACXL,MAAM,CAAG,IAAI,CACf,CAAC,CACH,CAAC,CAAE,CAACP,QAAQ,CAAC,CAAC,CAEdT,SAAS,CAAC,UAAM,CACdS,QAAQ,EACNM,mBAAmB,CACjBH,QAAQ,CAACU,MAAM,CAAC,SAACC,IAAI,QACnBC,OAAM,CAACC,OAAO,CAACf,OAAO,CAAC,CAACgB,KAAK,CAAC,kDAAEC,GAAG,UAAEC,KAAK,gBACxCL,KAAI,CAACI,GAAG,CAAC,CAACE,QAAQ,CAACD,KAAK,CAAC,GAC1B,GACF,CACF,CACL,CAAC,CAAE,CAAChB,QAAQ,CAAEH,QAAQ,CAAEC,OAAO,CAAC,CAAC,CAEjCV,SAAS,CAAC,UAAM,CACd,GAAIW,IAAI,GAAK,QAAQ,CAAE,CACrBI,mBAAmB,CAAC,SAACe,IAAI,QACvB,oBAAIA,IAAI,EAAEnB,IAAI,CAAC,SAACoB,CAAC,CAAEC,CAAC,QAAKD,EAAC,CAACE,SAAS,CAAGD,CAAC,CAACC,SAAS,GAAC,GACpD,CACH,CAAC,IAAM,IAAItB,IAAI,GAAK,KAAK,CAAE,CACzBI,mBAAmB,CAAC,SAACe,IAAI,QACvB,oBAAIA,IAAI,EAAEnB,IAAI,CAAC,SAACoB,CAAC,CAAEC,CAAC,QAAKD,EAAC,CAACG,KAAK,CAAGF,CAAC,CAACE,KAAK,GAAC,GAC5C,CACH,CAAC,IAAM,CACLnB,mBAAmB,CAAC,SAACe,IAAI,QACvB,oBAAIA,IAAI,EAAEnB,IAAI,CAAC,SAACoB,CAAC,CAAEC,CAAC,QAAKA,EAAC,CAACE,KAAK,CAAGH,CAAC,CAACG,KAAK,GAAC,GAC5C,CACH,CACF,CAAC,CAAE,CAACvB,IAAI,CAAC,CAAC,CAEV,mBACE,KAAC,SAAS,WACPF,QAAQ,CACLK,gBAAgB,CAACqB,GAAG,CAAC,SAAAZ,IAAI,qBAAK,KAAC,OAAO,EAAC,IAAI,CAAEA,IAAK,EAAMA,IAAI,CAACa,GAAG,CAAG,EAAC,CAAC,CACrExB,QAAQ,CAACuB,GAAG,CAAC,SAAAZ,IAAI,qBAAK,KAAC,OAAO,EAAC,IAAI,CAAEA,IAAK,EAAMA,IAAI,CAACa,GAAG,CAAG,EAAC,CAAC,EACvD,CAEhB,CAAC,CAED,2BAAe/B,IAAI,CAACG,QAAQ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}